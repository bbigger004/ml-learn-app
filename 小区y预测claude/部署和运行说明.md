# 小区y值预测系统 - 部署和运行说明

## 系统概述

这是一个基于NestJS后端和Vue3前端的Web应用程序，用于小区y值的机器学习预测。系统支持数据上传、特征选择、模型训练和预测结果可视化等功能。

## 环境要求

### 后端环境
- Node.js 16.0 或更高版本
- npm 或 yarn 包管理器
- 操作系统：Windows/Linux/macOS

### 前端环境
- Node.js 16.0 或更高版本
- npm 或 yarn 包管理器
- 现代浏览器（Chrome、Firefox、Safari、Edge）

## 安装步骤

### 1. 克隆项目
```bash
# 如果项目已经在当前目录，跳过此步骤
git clone <repository-url>
cd 小区y预测claude
```

### 2. 后端安装和配置

#### 2.1 安装后端依赖
```bash
cd 后端实现代码
npm install
```

#### 2.2 环境配置
创建后端环境配置文件 `.env`：
```env
# 服务器端口
PORT=3000

# 文件上传路径
UPLOAD_PATH=./uploads

# 模型保存路径
MODEL_PATH=./models

# CORS配置
CORS_ORIGIN=http://localhost:5173
```

#### 2.3 创建必要的目录
```bash
# 在项目根目录执行
mkdir -p uploads models
```

### 3. 前端安装和配置

#### 3.1 安装前端依赖
```bash
cd ../前端实现代码
npm install
```

#### 3.2 环境配置
创建前端环境配置文件 `.env`：
```env
# API基础URL
VITE_API_BASE_URL=http://localhost:3000/api

# 开发服务器端口
VITE_PORT=5173
```

## 运行系统

### 1. 启动后端服务
```bash
# 在后端目录中
cd 后端实现代码

# 开发模式
npm run start:dev

# 或者生产模式
npm run start:prod
```

后端服务将在 `http://localhost:3000` 启动。

### 2. 启动前端服务
```bash
# 在前端目录中
cd 前端实现代码

# 开发模式
npm run dev

# 或者构建生产版本
npm run build
npm run preview
```

前端服务将在 `http://localhost:5173` 启动。

### 3. 验证系统运行

1. 打开浏览器访问 `http://localhost:5173`
2. 系统应该正常加载，显示数据上传页面
3. 检查后端API文档：`http://localhost:3000/api/docs`

## 使用指南

### 1. 数据上传
1. 在数据上传页面，点击上传区域或拖拽CSV文件
2. 系统支持标准的CSV格式文件
3. 上传成功后可以预览数据结构和内容

### 2. 特征选择
1. 选择目标变量（通常是y列）
2. 选择用于训练的特征列
3. 查看特征的统计信息和类型

### 3. 模型训练
1. 配置训练参数（测试集比例、迭代次数等）
2. 开始训练模型
3. 查看训练结果和模型评估指标

### 4. 预测结果
1. 配置预测期数
2. 生成预测结果
3. 查看预测图表和数据表格
4. 导出预测结果

## 数据格式要求

### CSV文件格式
系统期望的CSV文件应包含以下列：
- `年月`: 时间标识，格式如 "202401"
- `小区ID`: 小区唯一标识
- `y`: 目标变量值
- `小区年限`: 小区建成年限
- `是否老旧小区`: 0或1
- `是否增长停滞`: 0或1
- `饱和度`: 数值型，0-1之间
- `变压器容量`: 数值型
- `变压器数量`: 数值型
- `用户数量`: 数值型
- `均价`: 数值型
- `建成年份`: 数值型
- `小区类型`: 分类变量

### 数据预处理
系统会自动进行以下预处理：
- 缺失值填充（数值型使用中位数，分类型使用众数）
- 异常值检测和处理
- 特征标准化
- 分类变量编码

## 故障排除

### 常见问题

#### 1. 后端启动失败
- 检查Node.js版本是否符合要求
- 确认端口3000未被占用
- 检查依赖是否完整安装

#### 2. 前端无法连接后端
- 确认后端服务正在运行
- 检查CORS配置
- 验证API基础URL配置

#### 3. 文件上传失败
- 检查文件大小是否超过限制（10MB）
- 确认文件格式为CSV
- 检查上传目录权限

#### 4. 模型训练失败
- 检查数据质量
- 确认选择了足够的特征
- 查看训练日志获取详细信息

### 日志查看

#### 后端日志
后端服务会在控制台输出详细的运行日志，包括：
- API请求和响应
- 文件操作记录
- 模型训练进度
- 错误信息

#### 前端日志
在浏览器开发者工具中查看：
- 网络请求状态
- JavaScript错误
- 控制台输出

## 性能优化建议

### 后端优化
1. **内存管理**: 对于大型数据集，考虑分批处理
2. **模型缓存**: 训练好的模型可以缓存到文件系统
3. **异步处理**: 长时间操作使用异步处理避免阻塞

### 前端优化
1. **数据分页**: 大数据集使用分页显示
2. **图表优化**: 大量数据点使用数据采样
3. **缓存策略**: 重复请求使用缓存

## 安全注意事项

1. **文件上传安全**: 系统会验证文件类型和大小
2. **数据保护**: 敏感数据应进行脱敏处理
3. **API安全**: 生产环境建议添加身份验证
4. **CORS配置**: 生产环境应限制允许的域名

## 扩展开发

### 添加新特征
1. 在后端的数据处理模块中添加特征工程逻辑
2. 在前端的特征选择组件中添加新特征选项
3. 更新API接口文档

### 添加新算法
1. 在后端的模型服务中实现新算法
2. 在前端的训练配置中添加算法参数
3. 更新模型评估逻辑

### 自定义可视化
1. 在前端的图表组件中添加新的图表类型
2. 实现自定义的数据格式化
3. 添加交互功能

## 技术支持

如果遇到问题，请：
1. 查看本文档的故障排除部分
2. 检查系统日志
3. 确认环境配置正确
4. 联系技术支持团队

---

**注意**: 本系统为演示版本，生产环境部署前请进行充分测试和安全评估。